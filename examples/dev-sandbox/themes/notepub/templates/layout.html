<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <link rel="stylesheet" href="{{ .AssetsBase }}/styles.css" />
  {{- if .Page.Description }}
  <meta name="description" content="{{ .Page.Description }}" />
  {{- end }}
  {{- if .Meta.Robots }}
  <meta name="robots" content="{{ .Meta.Robots }}" />
  {{- end }}
  {{- if .Canonical }}
  <link rel="canonical" href="{{ .Canonical }}" />
  {{- end }}
  {{- range .Meta.OpenGraph }}
  <meta property="{{ .Key }}" content="{{ .Value }}" />
  {{- end }}
  {{- if .Meta.JSONLD }}
  <script type="application/ld+json">{{ .Meta.JSONLD }}</script>
  {{- end }}
  <script>window.__notepubSearchMode = "{{ .SearchMode }}";</script>
  <title>{{ .Title }}</title>
</head>

<body>
  <header>
    <div class="header-inner">
      <a class="brand" href="{{ .BaseURL }}/" aria-label="Notepub">
        <span class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M7 17V7h2.2l5.6 7.2V7H17v10h-2.2L9.2 9.8V17H7z" fill="#0a0a0a"/>
          </svg>
        </span>
        <span>Notepub</span>
      </a>

      <div class="header-actions">
        <nav aria-label="Навигация">
          <a href="{{ .BaseURL }}/intro">Введение</a>
          <a href="{{ .BaseURL }}/getting-started">Старт</a>
          <a href="{{ .BaseURL }}/concepts">Концепции</a>
          <a href="{{ .BaseURL }}/themes">Темы</a>
          <a href="{{ .BaseURL }}/search">Поиск</a>
          <a href="{{ .BaseURL }}/seo">SEO</a>
          <a href="{{ .BaseURL }}/content-management">Контент</a>
          <a href="{{ .BaseURL }}/deploy">Деплой</a>
          <a href="{{ .BaseURL }}/integrations">Интеграции</a>
        </nav>
        <button class="nav-toggle" type="button" aria-label="Открыть навигацию" aria-controls="sidebar-tree" aria-expanded="false">
          ☰
        </button>
        {{ template "search_trigger.html" . }}
      </div>
    </div>
  </header>

  <main class="wrap">
    {{- if .IsHome }}
      {{ .Body }}
    {{- else }}
    <div class="layout">
      <div class="sidebar-backdrop" data-sidebar-close></div>
      <aside id="sidebar-tree" class="sidebar" aria-label="Навигация по документации">
        <div class="sidebar-section">
          <div class="sidebar-title">Документация</div>
          <ul class="sidebar-list">
            <li><a href="{{ .BaseURL }}/docs">Общий обзор</a></li>
            {{- $groups := .Collections.docs_items_grouped.Groups }}
            {{- if .Collections.docs_hubs.Items }}
              {{- range .Collections.docs_hubs.Items }}
              {{- $hubKey := printf "[[%s]]" .Slug }}
              <li class="sidebar-group">
                <a class="{{ if eq .Slug $.Page.Slug }}is-active{{ end }}" href="{{ $.BaseURL }}{{ .Path }}">{{ .Title }}</a>
                {{- if $groups }}
                <ul class="sidebar-sublist">
                  {{- range $groups }}
                    {{- if eq .Key $hubKey }}
                      {{- range .Items }}
                      <li>
                        <a class="{{ if and (eq .Slug $.Page.Slug) (ne $.Page.Type "hub") }}is-active{{ end }}" href="{{ $.BaseURL }}{{ .Path }}">{{ .Title }}</a>
                      </li>
                      {{- end }}
                    {{- end }}
                  {{- end }}
                </ul>
                {{- end }}
              </li>
              {{- end }}
            {{- end }}
          </ul>
        </div>
      </aside>
      <div class="content-area">
        {{ .Body }}
      </div>
    </div>
    {{- end }}
  </main>

  <footer class="wrap">
    <div class="footer-row">
      <span>Notepub</span>
      <span class="pill">Notepub: просто Markdown → умный сайт</span>
    </div>
    <p class="footer-copy">Контроль у вас. Структура по правилам. Контент навсегда.</p>
  </footer>
  <script>
  (function() {
    var btn = document.querySelector('.nav-toggle');
    var backdrop = document.querySelector('.sidebar-backdrop');
    var body = document.body;
    if (!btn) return;
    function closeSidebar() {
      body.classList.remove('sidebar-open');
      btn.setAttribute('aria-expanded', 'false');
    }
    function openSidebar() {
      body.classList.add('sidebar-open');
      btn.setAttribute('aria-expanded', 'true');
    }
    btn.addEventListener('click', function() {
      if (body.classList.contains('sidebar-open')) {
        closeSidebar();
      } else {
        openSidebar();
      }
    });
    if (backdrop) {
      backdrop.addEventListener('click', closeSidebar);
    }
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeSidebar();
    });
  })();
  </script>
</body>
</html>
